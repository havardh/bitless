\section{Testing the MCU Implementation}

This section describes the test written in software, and the energy measurements
done with {\bf energyAwareProfiler}. The software test can be divided into two
groups, {\bf Unit Test} and {\bf Demo programs}.

\subsection{Unit Tests}

Unit tests were developed for the non-hardware dependent code. These are utility components
which executes correctly independent on the underlying platform. The tests were written in
the CppUTest framework\ref{} and executed on each developers own laptop.

\subsection{Demo Program}

While developing the software library used to control the hardware through {\bf emlib} and
{\bf CMSIS}\todo{there is something wrong with this sentence}. These programs both verifies that the software operates correctly and that
the underlying hardware devices connected according to the specifications. By running the
program both on the produced circuit board and the development kits available at the lab.\todo{there is something wrong with this sentence}

\subsubsection{Transfer from ADC to DAC with DMA}
Location: sw/modules/adc/demo/ADD.c \\
This demo sets up the ADC as a sample source and the DAC as a sample output. It uses DMA
to copy from the ADC to an input buffer in the Internal RAM on the MCU. After 64 samples
the CPU is interrupted and transfers the samples to output buffer. A second DMA channel
copies from the output buffer to the DAC. This test verifies that this pipeline is set
up correctly. It checks that the minijacks are connected the correct GPIO ports. As
the ports are the same on the development kit \ref{} this test has been used to verify
the PCB design and implementation.

Sets up a simple path from ADC to DAC.
Verifies that ADC, DAC are setup correctly.

\subsubsection{Transfer from ADC to DAC Through FPGA Mock}
Location: sw/modules/fpga/demo/fpga.c
This demo is a copy of the previous test with the addition of deinterleaving and interleaving


Verifies that deinterleaving and interleaving works.

\subsubsection{copy-file.c}
Sets up MicroSD and copies the file sweet1.wav to sweet2.wav.
Verifies that SDCard is setup correctly.

\subsubsection{wavplayer.c}
Sets up the MicroSD, FPGA mock, DAC and DMA.
Verifies that audio can be played from SDCard to DAC.
