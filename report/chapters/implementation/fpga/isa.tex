% !TEX root = ../../../report.tex
\subsection{Instruction Set Architecture}\label{section:fpga-isa}

The processor was designed in a top-down fashion, starting with the instruction
set. The MIPS ISA used in the \textit{Computer
Design}\cite{tdt4255} course was a good starting point for the ISA used in this
project. In order to make the instruction set as general as possible, the
processor supports most common arithmetic operations. In addition the ISA was
optimized for the target application, especially operations supporting the SDFT.

To make the decoding of instructions as easy as possible, instructions
were divided into three different instruction groups.

\subsubsection{Register-based Instructions}

The register-based instructions are instructions operating on registers. With a
few exceptions the instructions follow the format $A = A op B$. The format of the
instructions are illustrated in Figure \ref{fig:regbased_instrs_format}. All of the
implemented functions can be found in the Appendix \ref{tab:regbased_instrs}.

\input{figures/fpga/isa-regbased-format}
\FloatBarrier

\subsubsection{Load Immediate Instruction}
The load immediate instruction is used to load an immediate constant into a
register. The format of the instruction can be found in figure
\ref{fig:ldi_format}. The value is loaded into register \texttt{\$r1}.

\input{figures/fpga/isa-ldi-format}
\FloatBarrier

\subsubsection{Branch Instruction}
The branch instruction checks condition flags and jumps accordingly. By
checking for various combinations of the condition flags, many different
conditions can be checked for. The format of the instruction is illustrated
in Figure \ref{fig:new_branch_format}.

\input{figures/fpga/isa-branch-format}
\FloatBarrier

\paragraph{Special Registers}

Due to the limited space in instruction words, at most two registers can be
specified in an instruction. Some instructions, such as the load immediate and
load constant instructions do not specify any registers, only an immediate
offset constant.

The list of defined special registers can be found in Table \ref{tab:specregs}.

\input{figures/fpga/isa-special-registers}
\FloatBarrier
