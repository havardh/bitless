% !TEX root = ../../report.tex
\subsection{Instruction Set Architecture}\label{section:fpga-isa}

The processor was designed in a top-down fashion, starting with
the instruction set. In order to support as many different filters
and effects as possible, the processor supports all normal arithmetic
operations. Due to the requirements of doing fourier transforms on the
processor, support for some floating point instructions was also included.

To make the decoding of instructions as easy as possible, instructions
were divided into three different instruction groups.

\subsubsection{Register-based Instructions}

The register-based instructions are instructions were both operands are
primarily registers. The group also includes a few instructions where
the second operand is an immediate value. The format of the
instructions are illustrated in figure \ref{fig:regbased_instrs_format}. The
implemented functions can be found in table \ref{tab:regbased_instrs}.

\todo{Fiks instruksjonstabellen}

\input{figures/fpga/isa-regbased-format}
\FloatBarrier
\input{figures/fpga/isa-regbased-instructions}
\FloatBarrier

\subsubsection{Load Immediate Instruction}
The load immediate instruction is used to load an immediate constant into a
register. The format of the instruction can be found in figure
\ref{fig:ldi_format}. The value is loaded into register \texttt{\$r1}.

\input{figures/fpga/isa-ldi-format}
\FloatBarrier

\subsubsection{Branch Instruction}
The branch instruction checks condition flags and jumps accordingly. By
checking for various combinations of the condition flags, many different
conditions can be checked for. The format of the instruction is illustrated
in figure \ref{fig:new_branch_format}. List for the encoding of the flags field
is coming later.

\input{figures/fpga/isa-branch-format}
\FloatBarrier

\paragraph{Special Registers}

Due to the limited space in instruction words, only two registers at most can be
specified in an instruction. Some instructions, such as the load immediate and
load constant instructions do not specify any registers, only an immediate
offset constant.

The list of defined special registers can be found in table \ref{tab:specregs}.
The register number for these registers have not yet been determined.

\input{figures/fpga/isa-special-registers}
\FloatBarrier
